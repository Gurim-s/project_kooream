<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.kooream.mapper.BiddingMapper">
	<select id="getMaxBidding" resultType="int">
		select nvl(max(bid_sell), 0)
		from bidding
		where p_no=#{p_no}
	</select>
	<select id="getMinBidding" resultType="int">
	<![CDATA[
		select nvl(min(bid_buy), 0)
		from bidding
		where p_no=#{p_no} and bid_buy<>0
	]]>
	</select>
	<insert id="insertBuyBid">
		INSERT INTO BIDDING(m_no, p_no, bid_sell, bid_buy) VALUES(99, #{p_no}, #{bid_sell}, #{bid_buy})
	</insert>
	
	<delete id="nowsell">
		delete from BIDDING where p_no=#{p_no} and bid_sell=#{bid_sell} and
		ROWNUM = (SELECT MIN(ROWNUM) FROM BIDDING where p_no =#{p_no} and bid_sell = #{bid_sell})
	</delete>
	
	<delete id="nowbuy">
		DELETE from BIDDING where p_no=#{p_no} and bid_buy=#{bid_buy} and
		ROWNUM = (SELECT MIN(ROWNUM) FROM BIDDING where p_no = #{p_no} and BID_BUY = #{bid_buy})
	</delete>
</mapper>